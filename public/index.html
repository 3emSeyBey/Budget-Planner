<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Budget Planner</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Smart budget management and expense tracking application">
    <meta name="theme-color" content="#0d6efd">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Budget Planner">
    <meta name="msapplication-TileColor" content="#1a1a1a">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json?v=2">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-16x16.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.css" rel="stylesheet">
    <link href="assets/css/style.css" rel="stylesheet">
</head>
<body>
    <!-- Particle Background -->
    <div id="particles-js"></div>
    
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-wallet me-2"></i>Smart Budget Planner
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#dashboard" data-section="dashboard" onclick="console.log('Dashboard clicked')">
                            <i class="fas fa-tachometer-alt me-1"></i>Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#budget" data-section="budget" onclick="console.log('Budget clicked')">
                            <i class="fas fa-chart-pie me-1"></i>Budget
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#expenses" data-section="expenses" onclick="console.log('Expenses clicked')">
                            <i class="fas fa-receipt me-1"></i>Expenses
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#analytics" data-section="analytics" onclick="console.log('Analytics clicked')">
                            <i class="fas fa-chart-line me-1"></i>Analytics
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#smart" data-section="smart" onclick="console.log('Smart clicked')">
                            <i class="fas fa-brain me-1"></i>Smart Features
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="content-section active">
            <div class="container mt-5 pt-4">
                <div class="row">
                    <div class="col-12">
                        <h2 class="mb-4">
                            <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                        </h2>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="row mb-4">
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card stat-card bg-primary text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h6 class="card-title">Weekly Budget</h6>
                                        <h4 class="mb-0">₱12,000</h4>
                                    </div>
                                    <div class="align-self-center">
                                        <i class="fas fa-wallet fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card stat-card bg-success text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h6 class="card-title">Spent This Week</h6>
                                        <h4 class="mb-0" id="weekly-spent">₱0</h4>
                                    </div>
                                    <div class="align-self-center">
                                        <i class="fas fa-shopping-cart fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card stat-card bg-info text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h6 class="card-title">Remaining</h6>
                                        <h4 class="mb-0" id="remaining-budget">₱12,000</h4>
                                    </div>
                                    <div class="align-self-center">
                                        <i class="fas fa-piggy-bank fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <div class="card stat-card bg-warning text-white">
                            <div class="card-body">
                                <div class="d-flex justify-content-between">
                                    <div>
                                        <h6 class="card-title">Budget Health</h6>
                                        <h4 class="mb-0" id="health-score">100%</h4>
                                    </div>
                                    <div class="align-self-center">
                                        <i class="fas fa-heartbeat fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Alerts -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-exclamation-triangle me-2"></i>Smart Alerts
                                </h5>
                            </div>
                            <div class="card-body" id="alerts-container">
                                <div class="text-center text-muted">
                                    <i class="fas fa-spinner fa-spin"></i> Loading alerts...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-plus-circle me-2"></i>Quick Add Expense
                                </h5>
                            </div>
                            <div class="card-body">
                                <form id="quick-expense-form">
                                    <div class="row">
                                        <div class="col-md-4 mb-3">
                                            <label class="form-label">Date</label>
                                            <input type="date" class="form-control" id="quick-date" required>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label class="form-label">Category</label>
                                            <select class="form-select" id="quick-category" required>
                                                <option value="">Select Category</option>
                                            </select>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label class="form-label">Amount</label>
                                            <input type="number" class="form-control" id="quick-amount" step="0.01" required>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Description</label>
                                        <input type="text" class="form-control" id="quick-description" placeholder="What did you spend on?">
                                    </div>
                                    <button type="submit" class="btn btn-primary w-100">
                                        <i class="fas fa-plus me-2"></i>Add Expense
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-pie me-2"></i>This Week's Budget
                                    <span class="badge bg-success ms-2" id="current-week-badge">Current</span>
                                </h5>
                            </div>
                            <div class="card-body">
                                <canvas id="budget-chart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Spending Progress Row -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-bar me-2"></i>Spending Progress - Current Week
                                    <span class="badge bg-info ms-2" id="progress-week-badge">Current</span>
                                </h5>
                            </div>
                            <div class="card-body">
                                <canvas id="spending-progress-chart" height="100"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Budget Section -->
        <section id="budget" class="content-section">
            <div class="container mt-5 pt-4">
                <div class="row">
                    <div class="col-12">
                        <h2 class="mb-4">
                            <i class="fas fa-chart-pie me-2"></i>Budget Management
                        </h2>
                    </div>
                </div>

                <!-- Week Selector -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Select Week</h5>
                                <div class="d-flex gap-2">
                                    <select class="form-select" id="budget-week-selector" title="Select Wednesday date">
                                        <option value="">Loading dates...</option>
                                    </select>
                                    <button class="btn btn-outline-primary" id="load-budget-btn">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                                <small class="text-muted">Select a Wednesday date from September 2025 onwards</small>
                                <div class="mt-2">
                                    <span class="badge bg-primary" id="current-week-display">Current Week: Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Quick Actions</h5>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-success" id="smart-adjust-btn">
                                        <i class="fas fa-magic me-1"></i>Smart Adjust
                                    </button>
                                    <button class="btn btn-info" id="predict-next-btn">
                                        <i class="fas fa-crystal-ball me-1"></i>Predict Next Week
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Budget Table -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Budget Allocation</h5>
                                <button class="btn btn-primary btn-sm" id="save-budget-btn">
                                    <i class="fas fa-save me-1"></i>Save Changes
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="budget-table">
                                        <thead>
                                            <tr>
                                                <th>Category</th>
                                                <th>Bank</th>
                                                <th>Planned Amount</th>
                                                <th>Action Plan</th>
                                                <th>Actual Spent</th>
                                                <th>Remaining</th>
                                                <th>Status</th>
                                                <th>Week</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="budget-table-body">
                                            <tr>
                                                <td colspan="9" class="text-center text-muted">
                                                    <i class="fas fa-spinner fa-spin"></i> Loading budget data...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Expenses Section -->
        <section id="expenses" class="content-section">
            <div class="container mt-5 pt-4">
                <div class="row">
                    <div class="col-12">
                        <h2 class="mb-4">
                            <i class="fas fa-receipt me-2"></i>Expense Tracking
                        </h2>
                    </div>
                </div>


                <!-- Expenses List -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Expenses by Week (Wednesday to Wednesday)</h5>
                                <div class="d-flex gap-2 align-items-center">
                                    <label class="form-label mb-0 me-2">Week Starting:</label>
                                    <input type="date" class="form-control form-control-sm" id="expense-week-start" style="width: auto;">
                                    <span class="text-muted me-2">to</span>
                                    <input type="date" class="form-control form-control-sm" id="expense-week-end" style="width: auto;" readonly>
                                    <button class="btn btn-outline-primary btn-sm" id="filter-expenses-btn">
                                        <i class="fas fa-filter me-1"></i>Filter
                                    </button>
                                    <button class="btn btn-outline-secondary btn-sm" id="current-week-btn">
                                        <i class="fas fa-calendar-week me-1"></i>Current Week
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="expenses-table">
                                        <thead>
                                            <tr>
                                                <th>Week Date</th>
                                                <th>Category</th>
                                                <th>Description</th>
                                                <th>Amount</th>
                                                <th>Payment Method</th>
                                                <th>Location</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="expenses-table-body">
                                            <tr>
                                                <td colspan="7" class="text-center text-muted">
                                                    <i class="fas fa-spinner fa-spin"></i> Loading expenses...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analytics" class="content-section">
            <div class="container mt-5 pt-4">
                <div class="row">
                    <div class="col-12">
                        <h2 class="mb-4">
                            <i class="fas fa-chart-line me-2"></i>Analytics & Reports
                        </h2>
                    </div>
                </div>

                <!-- Analytics Cards -->
                <div class="row mb-4">
                    <div class="col-md-4 mb-3">
                        <div class="card">
                            <div class="card-body text-center">
                                <h5 class="card-title">Spending Trends</h5>
                                <canvas id="trends-chart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card">
                            <div class="card-body text-center">
                                <h5 class="card-title">Top Categories</h5>
                                <canvas id="categories-chart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card">
                            <div class="card-body text-center">
                                <h5 class="card-title">Monthly Forecast</h5>
                                <canvas id="forecast-chart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Reports -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Detailed Analytics</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6>Spending by Category (Last 4 Weeks)</h6>
                                        <div id="category-breakdown"></div>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>Savings Recommendations</h6>
                                        <div id="savings-recommendations"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Smart Features Section -->
        <section id="smart" class="content-section">
            <div class="container mt-5 pt-4">
                <div class="row">
                    <div class="col-12">
                        <h2 class="mb-4">
                            <i class="fas fa-brain me-2"></i>Smart Features
                        </h2>
                    </div>
                </div>

                <!-- Smart Recommendations -->
                <div class="row mb-4">
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-magic me-2"></i>Smart Reallocation
                                </h5>
                            </div>
                            <div class="card-body">
                                <p class="text-muted">Get AI-powered suggestions for optimizing your budget allocation.</p>
                                <button class="btn btn-primary w-100" id="get-reallocations-btn">
                                    <i class="fas fa-cogs me-2"></i>Get Smart Suggestions
                                </button>
                                <div id="reallocations-container" class="mt-3"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-crystal-ball me-2"></i>Next Week Prediction
                                </h5>
                            </div>
                            <div class="card-body">
                                <p class="text-muted">Predict optimal budget allocation for next week based on your spending patterns.</p>
                                <button class="btn btn-info w-100" id="get-predictions-btn">
                                    <i class="fas fa-chart-line me-2"></i>Generate Prediction
                                </button>
                                <div id="predictions-container" class="mt-3"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Auto Adjustments -->
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-robot me-2"></i>Automatic Adjustments
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="text-center">
                                            <i class="fas fa-sync-alt fa-3x text-primary mb-3"></i>
                                            <h5>Auto-Adjust Next Week</h5>
                                            <p class="text-muted">Automatically adjust next week's budget based on current week's performance.</p>
                                            <button class="btn btn-success" id="auto-adjust-btn">
                                                <i class="fas fa-magic me-2"></i>Auto Adjust
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="text-center">
                                            <i class="fas fa-balance-scale fa-3x text-info mb-3"></i>
                                            <h5>Budget Balance</h5>
                                            <p class="text-muted">Ensure your weekly budget always totals exactly ₱12,000.</p>
                                            <button class="btn btn-info" id="balance-budget-btn">
                                                <i class="fas fa-equals me-2"></i>Balance Budget
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="text-center">
                                            <i class="fas fa-lightbulb fa-3x text-warning mb-3"></i>
                                            <h5>Smart Insights</h5>
                                            <p class="text-muted">Get personalized insights and recommendations for better money management.</p>
                                            <button class="btn btn-warning" id="get-insights-btn">
                                                <i class="fas fa-lightbulb me-2"></i>Get Insights
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modals -->
    <!-- Edit Budget Modal -->
    <div class="modal fade" id="editBudgetModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Budget Allocation</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-budget-form">
                        <input type="hidden" id="edit-category-id">
                        <input type="hidden" id="edit-week-date">
                        <div class="mb-3">
                            <label class="form-label">Category</label>
                            <input type="text" class="form-control" id="edit-category-name" readonly>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Amount</label>
                            <input type="number" class="form-control" id="edit-amount" step="0.01" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Notes</label>
                            <textarea class="form-control" id="edit-notes" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-edit-budget">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Weekly Budget Modal -->
    <div class="modal fade" id="weeklyBudgetModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Weekly Budget Limit</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="weekly-budget-form">
                        <div class="mb-3">
                            <label for="weekly-budget-limit" class="form-label">Weekly Budget Limit (₱)</label>
                            <input type="number" class="form-control" id="weekly-budget-limit" step="0.01" min="0" required>
                            <div class="form-text">This is the maximum amount you can allocate across all categories per week.</div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="budgetPlanner.saveWeeklyBudget()">Save Budget Limit</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Expense Modal -->
    <div class="modal fade" id="editExpenseModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Expense</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-expense-form">
                        <input type="hidden" id="edit-expense-id">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Date</label>
                                <input type="date" class="form-control" id="edit-expense-date" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Category</label>
                                <select class="form-select" id="edit-expense-category" required>
                                    <option value="">Select Category</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Amount</label>
                                <input type="number" class="form-control" id="edit-expense-amount" step="0.01" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Payment Method</label>
                                <select class="form-select" id="edit-expense-payment">
                                    <option value="Cash">Cash</option>
                                    <option value="GCash">GCash</option>
                                    <option value="Maya">Maya</option>
                                    <option value="BPI">BPI</option>
                                    <option value="CIMB">CIMB</option>
                                    <option value="UnoBank">UnoBank</option>
                                    <option value="GoTyme">GoTyme</option>
                                    <option value="GSave">GSave</option>
                                    <option value="MayBank">MayBank</option>
                                    <option value="Cebuana">Cebuana</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Description</label>
                                <input type="text" class="form-control" id="edit-expense-description">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Location</label>
                                <input type="text" class="form-control" id="edit-expense-location">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-edit-expense">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="assets/js/app.js"></script>
    <script>
        // Global variable to store the budget planner instance
        let budgetPlanner;
        
        // Initialize particle background
        function initParticles() {
            if (typeof particlesJS !== 'undefined') {
                particlesJS('particles-js', {
                    particles: {
                        number: {
                            value: 80,
                            density: {
                                enable: true,
                                value_area: 800
                            }
                        },
                        color: {
                            value: ['#6366f1', '#8b5cf6', '#06b6d4', '#10b981']
                        },
                        shape: {
                            type: 'circle',
                            stroke: {
                                width: 0,
                                color: '#000000'
                            }
                        },
                        opacity: {
                            value: 0.5,
                            random: false,
                            anim: {
                                enable: false,
                                speed: 1,
                                opacity_min: 0.1,
                                sync: false
                            }
                        },
                        size: {
                            value: 3,
                            random: true,
                            anim: {
                                enable: false,
                                speed: 40,
                                size_min: 0.1,
                                sync: false
                            }
                        },
                        line_linked: {
                            enable: true,
                            distance: 150,
                            color: '#6366f1',
                            opacity: 0.2,
                            width: 1
                        },
                        move: {
                            enable: true,
                            speed: 2,
                            direction: 'none',
                            random: false,
                            straight: false,
                            out_mode: 'out',
                            bounce: false,
                            attract: {
                                enable: false,
                                rotateX: 600,
                                rotateY: 1200
                            }
                        }
                    },
                    interactivity: {
                        detect_on: 'canvas',
                        events: {
                            onhover: {
                                enable: true,
                                mode: 'repulse'
                            },
                            onclick: {
                                enable: true,
                                mode: 'push'
                            },
                            resize: true
                        },
                        modes: {
                            grab: {
                                distance: 400,
                                line_linked: {
                                    opacity: 1
                                }
                            },
                            bubble: {
                                distance: 400,
                                size: 40,
                                duration: 2,
                                opacity: 8,
                                speed: 3
                            },
                            repulse: {
                                distance: 200,
                                duration: 0.4
                            },
                            push: {
                                particles_nb: 4
                            },
                            remove: {
                                particles_nb: 2
                            }
                        }
                    },
                    retina_detect: true
                });
            }
        }
        
        // Wait for DOM and Chart.js to be loaded before initializing the application
        function initializeApp() {
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initializeApp);
                return;
            }
            
            // Initialize particles first
            initParticles();
            
            // Register Service Worker for PWA
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('Service Worker registered successfully:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            }
            
            if (typeof Chart !== 'undefined') {
                budgetPlanner = new BudgetPlanner();
                console.log('Budget planner initialized');
            } else {
                // Retry after a short delay if Chart.js is not yet loaded
                setTimeout(initializeApp, 100);
            }
        }
        
        // Global function to test navigation
        function testNavigation(section) {
            console.log('Testing navigation to:', section);
            if (budgetPlanner) {
                budgetPlanner.showSection(section);
            } else {
                console.error('Budget planner not initialized');
            }
        }
        
        // Initialize the application
        initializeApp();
    </script>
</body>
</html>
